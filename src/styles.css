/* ==========================================================================
   1. DESIGN SYSTEM (GERENCIADOR DE TEMAS)
   ========================================================================== */
:root {
  /* --- TEMA PADRÃO (DARK AERO) --- */
  --bg-app: #1e1e2e;
  --bg-panel: #2b2b3b;
  --bg-input: #1e1e2e;
  --bg-card-hover: #323242;
  
  --primary: #8257e6;
  --primary-hover: #9466ff;
  
  --text-main: #e0e0e0;
  --text-muted: #a0a0a0;
  
  --border: #3e3e4e;
  
  --success: #04d361;
  --danger: #f75a68;
  --warning: #fba94c;
  --info: #00bcd4;

  --shadow-color: rgba(0,0,0,0.2);
  --glass-border: rgba(255,255,255,0.1);
  
  --radius-card: 16px;
  --radius-btn: 22px;
  --radius-input: 12px;
}

/* --- TEMA PASTEL ULTRAVIOLET DAWN --- */
[data-theme="pastel"] {
  --bg-app: #F8F5FA;              
  --bg-panel: #FFFFFF;            
  --bg-input: #FFFFFF;            
  --bg-card-hover: #F9F6FC;       

  --primary: #8B5CF6;             
  --primary-hover: #A78BFA;       

  --text-main: #2D2438;           
  --text-muted: #6B6078;          

  --border: #E2D9F3;              
  
  --success: #059669;             
  --danger: #DC2626;              
  --warning: #D97706;             
  --info: #0891B2;                

  --shadow-color: rgba(60, 40, 90, 0.06); 
  --glass-border: rgba(255, 255, 255, 0.8);
  
  --radius-card: 24px;
  --radius-btn: 24px;
  --radius-input: 16px;
}

body {
  margin: 0;
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  background-color: var(--bg-app);
  color: var(--text-main);
  height: 100vh;
  overflow: hidden;
  -webkit-font-smoothing: antialiased;
  transition: background-color 0.5s ease, color 0.5s ease;
}

/* ==========================================================================
   2. LAYOUT GERAL & COMPONENTES UI
   ========================================================================== */
.app-container { display: flex; height: 100vh; width: 100vw; }

.sidebar { 
  width: 260px; 
  background-color: var(--bg-panel); 
  border-right: 1px solid var(--border); 
  display: flex; 
  flex-direction: column; 
  padding: 24px; 
  z-index: 100; 
  box-shadow: 5px 0 15px var(--shadow-color); 
  transition: 0.5s; 
}

[data-theme="pastel"] .sidebar {
  background-color: rgba(255, 255, 255, 0.9);
  backdrop-filter: blur(20px);
  border-right: 1px solid #EAE4F5;
}

.main-content { flex: 1; overflow-y: auto; padding: 32px; position: relative; display: flex; flex-direction: column; }

/* Navegação */
.logo-area { margin-bottom: 40px; display: flex; align-items: center; gap: 10px; }
.logo-text { font-size: 1.5rem; font-weight: 800; color: var(--text-main); letter-spacing: -1px; }
.logo-highlight { color: var(--primary); }

[data-theme="pastel"] .logo-highlight {
  background: linear-gradient(90deg, #8B5CF6, #F472B6);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.nav-menu { display: flex; flex-direction: column; gap: 8px; }

.nav-item { 
  padding: 12px 16px; 
  border-radius: 12px; 
  color: var(--text-muted); 
  cursor: pointer; 
  font-weight: 500; 
  transition: all 0.3s ease; 
  display: flex; 
  align-items: center; 
  gap: 12px; 
}

.nav-item:hover { background-color: var(--bg-card-hover); color: var(--text-main); transform: translateX(5px); }

.nav-item.active { 
  background: linear-gradient(90deg, var(--primary) -50%, transparent 100%); 
  color: var(--primary); 
  border-left: 3px solid var(--primary); 
  font-weight: 700; 
}

[data-theme="pastel"] .nav-item.active {
  background: linear-gradient(90deg, rgba(139, 92, 246, 0.1) 0%, transparent 100%);
  color: #7C3AED;
  border-left: 4px solid #8B5CF6;
}

.header-area { display: flex; justify-content: space-between; align-items: center; margin-bottom: 32px; }
.page-title { font-size: 2rem; font-weight: 700; margin: 0; letter-spacing: -1px; }

.card { 
  background-color: var(--bg-panel); 
  border-radius: var(--radius-card); 
  border: 1px solid var(--border); 
  padding: 24px; 
  margin-bottom: 24px; 
  box-shadow: 0 10px 30px var(--shadow-color); 
  transition: 0.5s; 
}

[data-theme="pastel"] .card {
  box-shadow: 0 10px 40px -10px rgba(60, 40, 90, 0.08), 0 0 0 1px #F3F0F8;
  border: 1px solid transparent;
}

.btn { 
  height: 44px; padding: 0 24px; border-radius: var(--radius-btn); border: none; 
  background: linear-gradient(180deg, var(--primary) 0%, var(--primary-hover) 100%); 
  color: white; font-weight: 600; cursor: pointer; transition: all 0.2s; 
  box-shadow: 0 4px 15px var(--shadow-color); display: inline-flex; align-items: center; justify-content: center; gap: 8px; 
}

[data-theme="pastel"] .btn {
  background: linear-gradient(135deg, #8B5CF6 0%, #D946EF 100%);
  color: #fff;
  box-shadow: 0 10px 20px -5px rgba(139, 92, 246, 0.4); 
}

.btn:hover { transform: translateY(-2px) scale(1.05); filter: brightness(1.1); }
.btn:active { transform: translateY(0); }
.btn:disabled { opacity: 0.7; cursor: wait; }

.btn-secondary { 
  height: 44px; padding: 0 24px; border-radius: var(--radius-btn); border: 1px solid var(--border); 
  background: var(--bg-input); color: var(--text-main); font-weight: 600; cursor: pointer; 
  display: inline-flex; align-items: center; justify-content: center; transition: 0.2s; 
}

[data-theme="pastel"] .btn-secondary { border-color: #D1C4E9; background: #fff; color: #5B21B6; }
.btn-secondary:hover { border-color: var(--primary); color: var(--primary); }

.btn-sm { 
  padding: 6px 12px; font-size: 0.85rem; border-radius: 8px; border: 1px solid var(--border); 
  background: transparent; color: var(--text-muted); cursor: pointer; transition: 0.2s; 
}
[data-theme="pastel"] .btn-sm { border-color: #D1C4E9; color: #6D28D9; }
.btn-sm:hover { border-color: var(--text-main); color: var(--text-main); background: var(--bg-card-hover); }

.form-group { margin-bottom: 16px; }
.form-label { display: block; margin-bottom: 8px; font-size: 0.875rem; color: var(--text-muted); font-weight: 600; }

.form-input { 
  width: 100%; height: 44px; padding: 0 16px; border-radius: var(--radius-input); 
  border: 1px solid var(--border); background: var(--bg-input); color: var(--text-main); 
  box-sizing: border-box; transition: 0.3s; 
}

[data-theme="pastel"] .form-input { border: 1px solid #E2D9F3; background: #FFFFFF; color: #1F1A24; box-shadow: 0 2px 5px rgba(0,0,0,0.02); }
.form-input:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px var(--shadow-color); }
[data-theme="pastel"] .form-input:focus { border-color: #8B5CF6; box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.15); }
.form-textarea { resize: vertical; min-height: 80px; font-family: inherit; padding: 12px 16px; }

/* ==========================================================================
   3. DASHBOARD
   ========================================================================== */
.dashboard-grid { display: grid; grid-template-columns: 2fr 1fr; gap: 24px; margin-bottom: 24px; }
.stats-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 24px; margin-bottom: 32px; }

.stat-card { 
  background: linear-gradient(160deg, var(--bg-panel) 0%, var(--bg-app) 100%); 
  padding: 24px; border-radius: var(--radius-card); border: 1px solid var(--border); 
  position: relative; overflow: hidden; transition: transform 0.3s ease; 
  box-shadow: 0 4px 20px var(--shadow-color); 
}
[data-theme="pastel"] .stat-card { background: #fff; border: 1px solid #F3F0F8; }
.stat-card:hover { transform: translateY(-5px); border-color: var(--primary); }
.stat-card::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 4px; background: linear-gradient(90deg, var(--primary), var(--info)); }
.stat-label { font-size: 0.85rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px; font-weight: 700; margin-bottom: 10px; }
.stat-value { font-size: 2rem; font-weight: 700; color: var(--text-main); }
.stat-trend { font-size: 0.8rem; color: var(--text-muted); margin-top: 5px; opacity: 0.8; }

.chart-card { 
  background-color: var(--bg-panel); border-radius: var(--radius-card); 
  border: 1px solid var(--border); padding: 20px; display: flex; flex-direction: column; 
  height: 350px; box-shadow: 0 10px 30px var(--shadow-color); 
}
[data-theme="pastel"] .chart-card { background: #fff; border: 1px solid #F3F0F8; }
.chart-header { display: flex; justify-content: space-between; margin-bottom: 20px; }
.chart-title { font-weight: 600; color: var(--text-main); font-size: 1.1rem; }

/* ==========================================================================
   4. KANBAN BOARD
   ========================================================================== */
.kanban-board { display: flex; gap: 24px; height: 100%; overflow-x: auto; padding-bottom: 20px; padding-top: 10px; }

.kanban-column { 
  flex: 1; min-width: 300px; background-color: rgba(255, 255, 255, 0.01); 
  border-radius: var(--radius-card); padding: 16px; border: 1px solid var(--border); 
  display: flex; flex-direction: column; backdrop-filter: blur(5px); height: 100%;
}
[data-theme="pastel"] .kanban-column { background-color: rgba(255, 255, 255, 0.5); border: 1px solid #EAE4F5; }

.kanban-header { font-weight: 700; text-transform: uppercase; color: var(--text-muted); margin-bottom: 16px; display: flex; justify-content: space-between; font-size: 0.85rem; letter-spacing: 1px; }
.kanban-list-scroll { flex: 1; overflow-y: auto; padding: 4px; scrollbar-width: thin; }

.kanban-card {
  background: var(--bg-panel); border: 1px solid var(--border); border-radius: 12px; 
  padding: 16px; position: relative; overflow: hidden; display: flex; flex-direction: column; 
  gap: 8px; box-shadow: 0 4px 6px var(--shadow-color); width: 100%; box-sizing: border-box; cursor: grab;
}
[data-theme="pastel"] .kanban-card { background: #fff; border: 1px solid #EAE4F5; box-shadow: 0 4px 12px rgba(60, 40, 90, 0.05); }
.kanban-card:hover { transform: scale(1.02); box-shadow: 0 15px 35px var(--shadow-color); border-color: var(--primary); background: var(--bg-card-hover); }

.os-header { display: flex; justify-content: space-between; margin-bottom: 4px; pointer-events: none; }
.os-number { font-size: 0.75rem; font-weight: 700; color: var(--primary); background: var(--bg-input); border: 1px solid var(--border); padding: 4px 8px; border-radius: 6px; }
[data-theme="pastel"] .os-number { background: #F3E8FF; color: #6D28D9; border-color: #D8B4FE; }
.os-price { font-weight: 700; color: var(--success); font-family: monospace; font-size: 1.1rem; }
.os-client { font-weight: 600; font-size: 1.1rem; color: var(--text-main); pointer-events: none; }
.os-vehicle { font-size: 0.9rem; color: var(--text-muted); pointer-events: none; }
.os-id { font-size: 0.75rem; color: var(--text-muted); opacity: 0.8; pointer-events: none; }

.card-actions { margin-top: 10px; padding-top: 10px; border-top: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
.btn-icon { width: 36px; height: 36px; border-radius: 50%; border: 1px solid var(--border); color: var(--text-muted); display: flex; align-items: center; justify-content: center; cursor: pointer; background: var(--bg-input); transition: 0.2s; }
[data-theme="pastel"] .btn-icon { background: #F9FAFB; border-color: #E5E7EB; color: #4B5563; }
.btn-icon:hover { transform: scale(1.1); color: #fff; border-color: transparent; background: var(--primary); }
.btn-icon.check:hover { background: var(--success); }
.btn-icon.danger:hover { background: var(--danger); }

/* ==========================================================================
   5. PROCESSOS & CRM
   ========================================================================== */
.process-view { display: flex; flex-direction: column; gap: 30px; }
.process-table { width: 100%; border-collapse: separate; border-spacing: 0 8px; }
.process-row td { padding: 16px; border-top: 1px solid var(--border); border-bottom: 1px solid var(--border); background: var(--bg-panel); }
.process-row td:first-child { border-left: 1px solid var(--border); border-top-left-radius: 12px; border-bottom-left-radius: 12px; }
.process-row td:last-child { border-right: 1px solid var(--border); border-top-right-radius: 12px; border-bottom-right-radius: 12px; }

.status-badge { padding: 6px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 700; text-transform: uppercase; border: 1px solid transparent; }
.status-badge.st-ORCAMENTO { background: rgba(0, 188, 212, 0.15); color: var(--info); border-color: var(--info); }
.status-badge.st-APROVADO { background: rgba(255, 152, 0, 0.15); color: var(--warning); border-color: var(--warning); }
.status-badge.st-EM_SERVICO { background: rgba(130, 87, 230, 0.15); color: var(--primary); border-color: var(--primary); }
.status-badge.st-FINALIZADO { background: rgba(4, 211, 97, 0.15); color: var(--success); border-color: var(--success); }

/* Pastel Badges */
[data-theme="pastel"] .status-badge.st-ORCAMENTO { background: #E0F2FE; color: #0369A1; border: 1px solid #BAE6FD; }
[data-theme="pastel"] .status-badge.st-APROVADO { background: #FFFBEB; color: #B45309; border: 1px solid #FDE68A; }
[data-theme="pastel"] .status-badge.st-EM_SERVICO { background: #F5F3FF; color: #6D28D9; border: 1px solid #DDD6FE; }
[data-theme="pastel"] .status-badge.st-FINALIZADO { background: #ECFDF5; color: #047857; border: 1px solid #A7F3D0; }

.crm-layout { display: flex; height: 100%; gap: 24px; overflow: hidden; }
.client-list { width: 300px; overflow-y: auto; display: flex; flex-direction: column; gap: 12px; }
.client-list-item { background: var(--bg-panel); border: 1px solid var(--border); padding: 16px; border-radius: 12px; cursor: pointer; transition: 0.2s; }
.client-list-item:hover, .client-list-item.active { border-color: var(--primary); background: var(--bg-card-hover); transform: translateX(5px); }
.crm-details { flex: 1; background: var(--bg-panel); border: 1px solid var(--border); border-radius: var(--radius-card); padding: 32px; overflow-y: auto; }

/* ==========================================================================
   6. MODAIS E LOADING
   ========================================================================== */
.modal-overlay {
  position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
  background-color: rgba(0, 0, 0, 0.6); backdrop-filter: blur(4px); z-index: 1000;
  display: flex; align-items: center; justify-content: center; animation: fadeIn 0.2s ease-out;
}
[data-theme="pastel"] .modal-overlay { background-color: rgba(45, 30, 60, 0.4); backdrop-filter: blur(10px); }

.modal-content {
  background-color: var(--bg-panel); border: 1px solid var(--border); border-radius: var(--radius-card);
  padding: 32px; width: 90%; max-width: 800px; max-height: 90vh; overflow-y: auto;
  box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5); animation: scaleUp 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}
[data-theme="pastel"] .modal-content { box-shadow: 0 25px 50px -12px rgba(0,0,0,0.15); border-color: #fff; }

.modal-title { margin-top: 0; margin-bottom: 24px; font-size: 1.5rem; color: var(--text-main); border-bottom: 1px solid var(--border); padding-bottom: 16px; }
.modal-actions { display: flex; justify-content: flex-end; gap: 16px; margin-top: 32px; padding-top: 20px; border-top: 1px solid var(--border); }

.items-list-container { background: var(--bg-input); padding: 16px; border-radius: 12px; border: 1px solid var(--border); margin-bottom: 16px; }
[data-theme="pastel"] .items-list-container { background: #FAFAFA; border: 1px solid #E4E4E7; }

.items-header { display: flex; justify-content: space-between; font-weight: 700; color: var(--text-muted); text-transform: uppercase; font-size: 0.8rem; margin-bottom: 12px; }
.item-row { display: flex; gap: 10px; margin-bottom: 10px; align-items: center; }
.total-display { text-align: right; font-size: 1.5rem; font-weight: 700; color: var(--success); margin: 20px 0; padding: 10px; background: rgba(4, 211, 97, 0.1); border-radius: 12px; display: flex; justify-content: space-between; }

@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
@keyframes scaleUp { from { transform: scale(0.9) translateY(20px); opacity: 0; } to { transform: scale(1) translateY(0); opacity: 1; } }

.spinner { width: 16px; height: 16px; border: 2px solid rgba(255,255,255,0.3); border-radius: 50%; border-top-color: #fff; animation: spin 1s infinite; display: inline-block; }
@keyframes spin { to { transform: rotate(360deg); } }

.skeleton { background: linear-gradient(90deg, var(--bg-input) 25%, var(--bg-card-hover) 50%, var(--bg-input) 75%); background-size: 200% 100%; animation: shimmer 1.5s infinite; border-radius: 6px; width: 100%; min-height: 20px; display: block; }
@keyframes shimmer { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }

.confetti-container { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; pointer-events: none; z-index: 9999; overflow: hidden; }
.confetti-piece { position: absolute; width: 10px; height: 10px; background: var(--primary); top: -10px; animation: confetti-fall 3s linear forwards; }
@keyframes confetti-fall { 0% { transform: translateY(0) rotate(0deg); opacity: 1; } 100% { transform: translateY(100vh) rotate(720deg); opacity: 0; } }

/* ==========================================================================
   7. TABELAS DE DADOS
   ========================================================================== */
.data-table { width: 100%; border-collapse: collapse; }
.data-table th { text-align: left; padding: 12px; color: var(--text-muted); border-bottom: 1px solid var(--border); font-size: 0.85rem; }
.data-table td { padding: 12px; border-bottom: 1px solid var(--border); color: var(--text-main); font-size: 0.9rem; }
.data-table tr:hover { background-color: var(--bg-card-hover); }

/* ==========================================================================
   8. CONFIGURAÇÕES & SELETOR DE TEMAS
   ========================================================================== */
.theme-selection-area { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 20px; }
.theme-card-visual { background: var(--bg-input); border: 2px solid var(--border); border-radius: 20px; padding: 24px; cursor: pointer; transition: all 0.3s ease; position: relative; overflow: hidden; display: flex; flex-direction: column; gap: 16px; }
.theme-card-visual:hover { transform: translateY(-4px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); border-color: var(--text-muted); }
.theme-card-visual.active { border-color: var(--primary); background: var(--bg-panel); box-shadow: 0 0 0 2px var(--primary), 0 15px 35px var(--shadow-color); }
.theme-check-icon { position: absolute; top: 16px; right: 16px; width: 24px; height: 24px; border-radius: 50%; background: var(--primary); color: #fff; font-weight: bold; display: flex; align-items: center; justify-content: center; font-size: 0.8rem; opacity: 0; transform: scale(0); transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
.theme-card-visual.active .theme-check-icon { opacity: 1; transform: scale(1); }
.theme-preview-palette { display: flex; gap: 12px; }
.theme-color-swatch { width: 40px; height: 40px; border-radius: 50%; border: 2px solid rgba(255,255,255,0.2); box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
.theme-info h4 { margin: 0 0 8px 0; color: var(--text-main); font-size: 1.1rem; }
.theme-info p { margin: 0; color: var(--text-muted); font-size: 0.9rem; line-height: 1.4; }

/* ==========================================================================
   9. VISTORIA VISUAL
   ========================================================================== */
.fuel-gauge { display: flex; gap: 4px; margin-top: 8px; }
.fuel-bar { flex: 1; height: 8px; background: var(--border); border-radius: 4px; cursor: pointer; transition: 0.3s; }
.fuel-bar:hover { transform: scaleY(1.5); }
.fuel-bar.active-0 { background: var(--danger); box-shadow: 0 0 10px var(--danger); }
.fuel-bar.active-1 { background: var(--warning); }
.fuel-bar.active-2 { background: var(--info); }
.fuel-bar.active-3 { background: var(--primary); }
.fuel-bar.active-4 { background: var(--success); box-shadow: 0 0 10px var(--success); }
.tires-container { display: flex; justify-content: center; margin: 24px 0; }
.tire-grid { display: grid; grid-template-areas: "fl body fr" "bl body br"; grid-template-columns: 60px 120px 60px; gap: 16px; align-items: center; }
.tire-item { width: 100%; height: 80px; background: var(--bg-app); border: 2px solid var(--success); border-radius: 12px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; transition: 0.3s; }
.tire-item.damaged { border-color: var(--danger); background: rgba(247, 90, 104, 0.1); color: var(--danger); }
.car-silhouette { grid-area: body; height: 180px; border: 2px solid var(--border); border-radius: 24px; position: relative; background: rgba(255,255,255,0.02); }

/* ==========================================================================
   10. PROCESSOS (AGRUPAMENTO)
   ========================================================================== */
.process-group { margin-bottom: 32px; animation: fadeIn 0.3s ease-out; }
.process-group-header { display: inline-flex; align-items: center; gap: 12px; padding: 10px 24px; background: var(--bg-panel); border: 1px solid var(--border); border-bottom: none; border-radius: 12px 12px 0 0; font-weight: 800; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px; position: relative; z-index: 1; box-shadow: 0 -4px 10px var(--shadow-color); }
.count-badge { background: var(--bg-input); color: var(--text-main); padding: 2px 8px; border-radius: 12px; font-size: 0.75rem; border: 1px solid var(--border); }
.process-group-header.status-ORCAMENTO { border-top: 4px solid var(--info); color: var(--info); }
.process-group-header.status-APROVADO { border-top: 4px solid var(--warning); color: var(--warning); }
.process-group-header.status-EM_SERVICO { border-top: 4px solid var(--primary); color: var(--primary); }
.process-group-header.status-FINALIZADO { border-top: 4px solid var(--success); color: var(--success); }
[data-theme="pastel"] .process-group-header { background: #fff; border-color: #E2D9F3; }
[data-theme="pastel"] .process-group-header.status-ORCAMENTO { color: #0369A1; border-top-color: #0EA5E9; background: #F0F9FF; }
[data-theme="pastel"] .process-group-header.status-APROVADO { color: #B45309; border-top-color: #F59E0B; background: #FFFBEB; }
[data-theme="pastel"] .process-group-header.status-EM_SERVICO { color: #6D28D9; border-top-color: #8B5CF6; background: #F5F3FF; }
[data-theme="pastel"] .process-group-header.status-FINALIZADO { color: #047857; border-top-color: #10B981; background: #ECFDF5; }
.sortable-th { cursor: pointer; user-select: none; transition: background 0.2s, color 0.2s; }
.sortable-th:hover { background-color: var(--bg-card-hover); color: var(--primary); }
.cell-primary { font-weight: 600; color: var(--text-main); margin-bottom: 2px; }
.cell-secondary { font-size: 0.85rem; color: var(--text-muted); }

/* ==========================================================================
   11. DROPDOWN STATUS
   ========================================================================== */
.status-cell { position: relative; cursor: pointer; }
.status-dropdown-menu { position: absolute; top: 100%; right: 0; margin-top: 8px; background: var(--bg-panel); border: 1px solid var(--border); border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); z-index: 100; min-width: 160px; overflow: hidden; animation: fadeIn 0.2s ease-out; }
[data-theme="pastel"] .status-dropdown-menu { background: #FFFFFF; box-shadow: 0 10px 40px -10px rgba(60, 40, 90, 0.15); border-color: #E2D9F3; }
.status-option { padding: 10px 16px; font-size: 0.85rem; color: var(--text-main); cursor: pointer; transition: background 0.2s; display: flex; align-items: center; gap: 8px; }
.status-option:hover { background: var(--bg-card-hover); color: var(--primary); }
.status-option.selected { background: rgba(130, 87, 230, 0.1); font-weight: 700; color: var(--primary); }
[data-theme="pastel"] .status-option.selected { background: #F3E8FF; color: #7C3AED; }
.dropdown-arrow { display: inline-block; margin-left: 6px; font-size: 0.7rem; opacity: 0.6; transition: transform 0.2s; }
.status-cell:hover .dropdown-arrow { transform: translateY(2px); opacity: 1; }

/* ==========================================================================
   12. TIMELINE CRM (VERTICAL CORRIGIDA)
   ========================================================================== */

/* Container Principal: Garante que os itens fiquem um EMBAIXO do outro */
.timeline-container {
    display: flex;
    flex-direction: column; /* CORREÇÃO: flex-direction (kebab-case) */
    gap: 0;
    padding-bottom: 20px;
    padding-left: 10px; /* Pequeno respiro na esquerda */
}

/* Cada "Linha" da Timeline (Data + Marcador + Card) */
.timeline-item {
    display: flex;
    flex-direction: row; /* Itens alinhados lado a lado dentro da linha */
    gap: 20px;
    position: relative;
    padding-bottom: 30px; /* Espaço vertical entre os eventos */
}

/* 1. Coluna da Data (Esquerda) */
.timeline-date-col {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    min-width: 60px;
    text-align: center;
    padding-top: 2px; /* Alinha visualmente com o topo do card */
}

.tl-day { 
    font-size: 1.4rem; 
    font-weight: 800; 
    color: var(--text-main); 
    line-height: 1; 
}
.tl-month { 
    font-size: 0.75rem; 
    font-weight: 700; 
    text-transform: uppercase; 
    color: var(--primary); 
    margin-top: 2px; 
    letter-spacing: 1px;
}
.tl-year { 
    font-size: 0.7rem; 
    color: var(--text-muted); 
    opacity: 0.6; 
}

/* 2. Coluna do Marcador (Linha Vertical + Bolinha) */
.timeline-marker-col {
    display: flex;
    flex-direction: column;
    align-items: center;
    position: relative;
    min-width: 24px; 
}

/* A Linha Vertical Conectora */
.tl-line {
    position: absolute;
    top: 18px; /* Começa logo abaixo da bolinha */
    bottom: -35px; /* Estende até a próxima bolinha */
    width: 2px;
    background-color: var(--border);
    opacity: 0.6;
    z-index: 0;
}

/* Remove a linha do último item */
.timeline-item:last-child .tl-line { 
    display: none; 
}

/* A Bolinha (Nó) */
.tl-dot {
    width: 14px;
    height: 14px;
    border-radius: 50%;
    background-color: var(--bg-panel);
    border: 3px solid var(--border);
    z-index: 2; /* Fica acima da linha */
    margin-top: 5px; /* Alinha com o topo do card/data */
    box-shadow: 0 0 0 4px var(--bg-panel); /* Cria uma "máscara" ao redor para separar da linha */
    transition: all 0.3s ease;
}

/* Cores dos Status */
.tl-dot.st-FINALIZADO { border-color: var(--success); background-color: var(--success); }
.tl-dot.st-EM_SERVICO { border-color: var(--primary); background-color: var(--primary); }
.tl-dot.st-ORCAMENTO { border-color: var(--info); }
.tl-dot.st-APROVADO { border-color: var(--warning); }

/* Efeito Hover na Linha inteira */
.timeline-item:hover .tl-dot { transform: scale(1.3); }

/* 3. Coluna do Conteúdo (Card à Direita) */
.timeline-content-card {
    flex: 1; /* Ocupa o resto do espaço */
    background: var(--bg-input);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 16px 20px;
    position: relative;
    transition: all 0.2s ease;
    box-shadow: 0 2px 5px rgba(0,0,0,0.02);
}

/* Pequena seta apontando para a esquerda (bolinha) */
.timeline-content-card::before {
    content: '';
    position: absolute;
    left: -6px;
    top: 12px;
    width: 10px;
    height: 10px;
    background: var(--bg-input);
    border-left: 1px solid var(--border);
    border-bottom: 1px solid var(--border);
    transform: rotate(45deg);
}

[data-theme="pastel"] .timeline-content-card {
    background: #FFFFFF;
    border-color: #F0F0F0;
    box-shadow: 0 4px 15px -3px rgba(60, 40, 90, 0.05);
}
[data-theme="pastel"] .timeline-content-card::before {
    background: #FFFFFF;
    border-color: #F0F0F0;
}

.timeline-content-card:hover {
    transform: translateY(-2px);
    border-color: var(--primary);
    box-shadow: 0 8px 20px rgba(0,0,0,0.1);
}

.tl-card-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 8px;
}

.tl-vehicle {
    font-weight: 700;
    font-size: 1.05rem;
    color: var(--text-main);
}

.tl-card-body {
    font-size: 0.9rem;
    color: var(--text-muted);
    margin-bottom: 12px;
    line-height: 1.5;
}

.tl-card-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-top: 1px dashed var(--border);
    padding-top: 10px;
    margin-top: 5px;
}

.tl-os-number {
    font-size: 0.75rem;
    color: var(--text-muted);
    font-family: monospace;
    background: rgba(0,0,0,0.03);
    padding: 3px 8px;
    border-radius: 6px;
}

.tl-price {
    font-weight: 800;
    color: var(--text-main);
    font-size: 1.1rem;
}

/* ==========================================================================
   13. ESTILOS DE IMPRESSÃO (TABLE LAYOUT + CLEAN HEADERS)
   ========================================================================== */
.printable-invoice { display: none; }

@media print {
  /* 1. REMOVE CABEÇALHOS DO NAVEGADOR (Data, Hora, URL)
     Ao definir a margem da página como 0, o navegador remove os metadados automáticos.
  */
  @page { 
    margin: 0; 
    size: A4; 
  }
  
  /* 2. RESET GLOBAL PARA IMPRESSÃO */
  :root, html, body, #root {
    background-color: #FFFFFF !important;
    background: #FFFFFF !important;
    color: #000000 !important;
    height: 100%;
    width: 100%;
    margin: 0 !important;
    padding: 0 !important;
    overflow: visible !important;
  }

  .app-container, .modal-overlay, .sidebar, .main-content, .confetti-container, .toast-container { 
    display: none !important; 
  }

  /* 3. CONTAINER PRINCIPAL */
  .printable-invoice {
    display: block !important;
    background-color: #FFFFFF !important;
    font-family: 'Inter', Helvetica, Arial, sans-serif;
    color: #111;
    width: 100%;
    /* Simulamos a margem da página aqui com padding */
    padding: 15mm 15mm 0 15mm; 
    box-sizing: border-box;
    font-size: 11px; /* Tamanho base otimizado */
  }

  /* --- ESTRUTURA DA TABELA DE LAYOUT --- */
  .invoice-layout-table {
    width: 100%;
    border-collapse: collapse;
  }

  .invoice-layout-table td {
    padding: 0;
    vertical-align: top;
  }

  /* O SEGREDO DO RODAPÉ: Alturas sincronizadas */
  .footer-space, .invoice-fixed-footer {
    height: 180px; /* Altura reservada para assinaturas e textos */
  }

  .footer-space {
    display: block;
    width: 100%;
  }

  .invoice-fixed-footer {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    padding: 0 15mm 10mm 15mm; /* Padding interno do rodapé */
    box-sizing: border-box;
    background-color: #FFFFFF;
    z-index: 9999;
  }

  /* --- ESTILOS INTERNOS --- */

  /* Header */
  .invoice-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 25px; padding-top: 20px; }
  .invoice-col { flex: 1; }
  .client-col { text-align: right; }
  
  .label-sm { font-size: 0.65rem; color: #888; letter-spacing: 1px; margin-bottom: 4px; font-weight: 700; text-transform: uppercase; }
  .company-name, .client-name { font-size: 1.1rem; font-weight: 800; margin: 0 0 4px 0; text-transform: uppercase; color: #000; }
  .invoice-col p { margin: 2px 0; font-size: 0.8rem; color: #333; }

  .invoice-logo-area { flex: 1; display: flex; justify-content: center; align-items: center; }
  .invoice-logo-circle { width: 50px; height: 50px; background-color: #222; color: #fff; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; font-weight: bold; -webkit-print-color-adjust: exact; print-color-adjust: exact; }

  .divider { border: 0; border-top: 1px solid #ddd; margin: 15px 0; }

  /* Meta Dados */
  .invoice-meta-grid { display: flex; justify-content: space-between; margin-bottom: 25px; }
  .meta-item { display: flex; flex-direction: column; }
  .meta-value { font-size: 1rem; font-weight: 600; margin-top: 4px; color: #000; }
  .meta-value.highlight { font-weight: 800; }
  .meta-value.status-print { font-size: 0.8rem; text-transform: uppercase; border: 1px solid #000; padding: 2px 6px; border-radius: 4px; }

  /* Tabelas de Itens */
  .section-title {
    color: #8B5CF6; font-size: 0.7rem; font-weight: 800; text-transform: uppercase; letter-spacing: 1px;
    margin: 0 0 5px 0; border-bottom: 2px solid #8B5CF6; display: inline-block; padding-bottom: 2px;
  }

  .invoice-items-table { width: 100%; border-collapse: collapse; margin-bottom: 5px; }
  .invoice-items-table th { padding: 6px 0; border-bottom: 1px solid #bbb; font-size: 0.7rem; color: #444; text-transform: uppercase; font-weight: 700; }
  .invoice-items-table td { padding: 6px 0; border-bottom: 1px solid #eee; font-size: 0.85rem; color: #111; }
  .text-right { text-align: right; }

  /* Subtotais */
  .subtotal-row {
    text-align: right; font-size: 0.85rem; font-weight: 600; color: #444;
    padding: 8px 0; display: flex; justify-content: flex-end; gap: 20px;
    page-break-inside: avoid;
  }
  .subtotal-value { font-weight: 700; color: #000; }

  /* Total Geral */
  .invoice-total-block { 
    display: flex; justify-content: flex-end; 
    margin-top: 20px; padding-top: 15px; 
    border-top: 2px solid #000;
    page-break-inside: avoid;
  }
  .total-line { text-align: right; }
  .label-total { font-size: 0.9rem; letter-spacing: 1px; color: #8B5CF6; font-weight: 700; margin-right: 15px; }
  .value-total { font-weight: 900; color: #000; font-size: 1.8rem; line-height: 1; }

  /* Rodapé Fixo */
  .signature-area { 
    display: flex; justify-content: space-between; 
    margin-top: 20px; margin-bottom: 20px; padding: 0 10px;
  }
  .signature-block { width: 40%; text-align: center; }
  .sign-line { border-top: 1px solid #000; margin-bottom: 5px; height: 1px; width: 100%; }
  .sign-name { display: block; font-size: 0.85rem; font-weight: 700; color: #000; }
  .sign-label { display: block; font-size: 0.6rem; color: #666; text-transform: uppercase; letter-spacing: 1px; margin-top: 2px; }

  .footer-text-block { text-align: center; border-top: 1px dashed #ddd; padding-top: 10px; }
  .declaration-text { font-size: 0.65rem; color: #333; margin-bottom: 5px; }
  .thank-you-msg { font-size: 0.75rem; font-weight: 800; letter-spacing: 2px; text-transform: uppercase; color: #8B5CF6; }
}

/* ==========================================================================
   14. REMOÇÃO DE SETAS (SPINNERS) EM INPUTS NUMÉRICOS
   ========================================================================== */
/* Chrome, Safari, Edge, Opera */
input[type=number]::-webkit-outer-spin-button,
input[type=number]::-webkit-inner-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

/* Firefox */
input[type=number] {
  -moz-appearance: textfield;
}

/* ==========================================================================
   15. NOTIFICAÇÕES TOAST (SUBSTITUI ALERTS)
   ========================================================================== */
.toast-container {
  position: fixed;
  top: 24px;
  right: 24px;
  z-index: 9999;
  display: flex;
  flex-direction: column;
  gap: 12px;
  pointer-events: none; /* Permite clicar através do container */
}

.toast {
  pointer-events: auto;
  min-width: 300px;
  padding: 16px 20px;
  border-radius: 12px;
  background: var(--bg-panel);
  border: 1px solid var(--border);
  color: var(--text-main);
  box-shadow: 0 10px 30px rgba(0,0,0,0.3);
  display: flex;
  align-items: center;
  gap: 12px;
  animation: slideInRight 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  font-weight: 500;
  font-size: 0.9rem;
  position: relative;
  overflow: hidden;
}

/* Animação de Entrada */
@keyframes slideInRight {
  from { transform: translateX(100%); opacity: 0; }
  to { transform: translateX(0); opacity: 1; }
}

/* Barra de Progresso (Tempo) */
.toast::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  height: 3px;
  background: currentColor;
  opacity: 0.5;
  width: 100%;
  animation: toast-timer 3s linear forwards;
}

@keyframes toast-timer {
  from { width: 100%; }
  to { width: 0%; }
}

/* --- VARIAÇÕES POR TIPO --- */

/* Sucesso */
.toast.success { border-left: 4px solid var(--success); }
.toast.success .toast-icon { color: var(--success); }

/* Erro */
.toast.error { border-left: 4px solid var(--danger); }
.toast.error .toast-icon { color: var(--danger); }

/* Info */
.toast.info { border-left: 4px solid var(--info); }
.toast.info .toast-icon { color: var(--info); }

/* --- ADAPTAÇÃO AO TEMA PASTEL --- */
[data-theme="pastel"] .toast {
  background: #FFFFFF;
  box-shadow: 0 10px 40px -10px rgba(60, 40, 90, 0.15);
  border: 1px solid #E2D9F3;
  color: var(--text-main);
}

[data-theme="pastel"] .toast.success { background: #ECFDF5; border-color: #A7F3D0; border-left-color: #059669; color: #065F46; }
[data-theme="pastel"] .toast.error { background: #FEF2F2; border-color: #FECACA; border-left-color: #DC2626; color: #991B1B; }
[data-theme="pastel"] .toast.info { background: #F0F9FF; border-color: #BAE6FD; border-left-color: #0284C7; color: #075985; }

/* ==========================================================================
   PERFORMANCE TWEAKS (OVERHAUL)
   ========================================================================== */

/* Forçar aceleração de hardware nos cards */
.kanban-card {
  /* Evita repintar o layout inteiro ao mover */
  transform: translateZ(0); 
  backface-visibility: hidden;
  will-change: transform, box-shadow;
}

/* Otimização da Sidebar para não repintar ao fazer hover nos itens */
.sidebar {
  will-change: width;
}

/* Remove blur pesado em telas ou máquinas que não suportam bem */
@media (prefers-reduced-motion: reduce) {
  .kanban-column, .sidebar {
    backdrop-filter: none !important;
    background-color: var(--bg-panel) !important;
  }
  * {
    animation-duration: 0.01ms !important;
    transition-duration: 0.01ms !important;
  }
}

/* Melhora a performance de scroll nas listas */
.kanban-list-scroll, .main-content {
  -webkit-overflow-scrolling: touch;
  scroll-behavior: smooth;
}

/* ==========================================================================
   KANBAN SEARCH & FILTER
   ========================================================================== */
.kanban-filter-bar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 20px;
  background: var(--bg-panel);
  padding: 12px 20px;
  border-radius: var(--radius-card);
  border: 1px solid var(--border);
  box-shadow: 0 4px 6px var(--shadow-color);
  gap: 20px;
}

[data-theme="pastel"] .kanban-filter-bar {
  background: #FFFFFF;
  border-color: #EAE4F5;
}

.search-wrapper {
  position: relative;
  flex: 1;
  max-width: 400px;
}

.search-icon {
  position: absolute;
  left: 12px;
  top: 50%;
  transform: translateY(-50%);
  color: var(--text-muted);
  font-size: 1rem;
  pointer-events: none;
}

.search-input {
  padding-left: 40px !important; /* Espaço para o ícone */
  border-radius: 20px !important;
}

.btn-clear-search {
  position: absolute;
  right: 12px;
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  color: var(--text-muted);
  cursor: pointer;
  font-weight: bold;
}
.btn-clear-search:hover { color: var(--danger); }

.filter-stats {
  font-size: 0.85rem;
  color: var(--text-muted);
}
.filter-stats strong {
  color: var(--text-main);
}

/* ==========================================================================
   SCROLLBAR PERSONALIZADA E ESTABILIDADE DE JANELA
   ========================================================================== */

/* 1. Travar o scroll "elástico" do corpo da página para evitar pulos */
html, body {
  overflow: hidden; /* Remove barra de rolagem da janela principal */
  height: 100%;
  width: 100%;
}

/* 2. Estilização Global da Barra de Rolagem (Webkit - Chrome/Edge/Tauri) */
* {
  /* Propriedade moderna para evitar layout shift quando a barra aparece */
  scrollbar-gutter: stable;
  scrollbar-width: thin; /* Firefox */
  scrollbar-color: var(--border) transparent; /* Firefox */
}

::-webkit-scrollbar {
  width: 8px;  /* Largura vertical */
  height: 8px; /* Altura horizontal */
}

::-webkit-scrollbar-track {
  background: transparent; /* Fundo invisível */
  margin: 4px 0;
}

::-webkit-scrollbar-thumb {
  background-color: var(--border); /* Cor da barra */
  border-radius: 20px;       /* Arredondamento */
  border: 2px solid transparent; /* Cria um respiro interno */
  background-clip: content-box;
}

::-webkit-scrollbar-thumb:hover {
  background-color: var(--text-muted); /* Cor ao passar o mouse */
}

::-webkit-scrollbar-corner {
  background: transparent;
}

/* Ajuste específico para Listas dentro de Modais e Cards */
.kanban-list-scroll, 
.modal-content, 
.sidebar, 
.main-content,
.items-list-scroll {
  overflow-y: auto;
  overflow-x: hidden;
}

/* Garante que o modal não ultrapasse a tela e gere barra dupla */
.modal-content {
  max-height: 90vh;
  display: flex;
  flex-direction: column;
}